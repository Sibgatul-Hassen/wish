<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Happy Anniversary</title>
    <script src="/_sdk/element_sdk.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&amp;family=Playfair+Display:wght@400;700&amp;family=Great+Vibes&amp;display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        height: 100%;
        overflow-x: hidden;
        font-family: "Playfair Display", serif;
        background: linear-gradient(
          135deg,
          #ffeef8 0%,
          #e8f5ff 30%,
          #fff4e6 70%,
          #f0e6ff 100%
        );
        position: relative;
      }

      html {
        height: 100%;
      }

      .container {
        position: relative;
        width: 100%;
        min-height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
        z-index: 1;
      }

      .emoji-decoration {
        position: absolute;
        font-size: 40px;
        animation: float 3s ease-in-out infinite;
        opacity: 0.8;
        z-index: 200; /* Ensure above fireworks canvas */
      }

      .emoji-decoration:nth-child(1) {
        top: 10%;
        left: 10%;
        animation-delay: 0s;
      }
      .emoji-decoration:nth-child(2) {
        top: 20%;
        right: 15%;
        animation-delay: 1s;
      }
      .emoji-decoration:nth-child(3) {
        top: 60%;
        left: 5%;
        animation-delay: 2s;
      }
      .emoji-decoration:nth-child(4) {
        top: 70%;
        right: 10%;
        animation-delay: 0.5s;
      }
      .emoji-decoration:nth-child(5) {
        top: 40%;
        left: 8%;
        animation-delay: 1.5s;
      }
      .emoji-decoration:nth-child(6) {
        top: 30%;
        right: 8%;
        animation-delay: 2.5s;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(5deg);
        }
      }

      .main-title {
        font-family: "Great Vibes", cursive;
        font-size: 80px;
        font-weight: 700;
        background: linear-gradient(45deg, #ff6b9d, #c44569, #ff9ff3, #f368e0);
        background-size: 400% 400%;
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
        margin-bottom: 20px;
        opacity: 0;
        transform: scale(0.3) rotateY(90deg);
        animation: premiumTitleAppear 3s ease-out 0.5s forwards,
          gradientShift 4s ease-in-out infinite;
        text-shadow: 0 0 50px rgba(255, 107, 157, 0.5);
        position: relative;
      }

      .main-title::before {
        content: "‚ú®";
        position: absolute;
        left: -60px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 50px;
        animation: sparkle 2s ease-in-out infinite;
      }

      .main-title::after {
        content: "‚ú®";
        position: absolute;
        right: -60px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 50px;
        animation: sparkle 2s ease-in-out infinite 1s;
      }

      @keyframes premiumTitleAppear {
        0% {
          opacity: 0;
          transform: scale(0.3) rotateY(90deg);
        }
        50% {
          opacity: 0.7;
          transform: scale(1.1) rotateY(0deg);
        }
        100% {
          opacity: 1;
          transform: scale(1) rotateY(0deg);
        }
      }

      @keyframes gradientShift {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      @keyframes sparkle {
        0%,
        100% {
          opacity: 1;
          transform: translateY(-50%) scale(1);
        }
        50% {
          opacity: 0.3;
          transform: translateY(-50%) scale(1.3);
        }
      }

      .couple-names {
        font-family: "Dancing Script", cursive;
        font-size: 48px;
        font-weight: 700;
        color: #8e44ad;
        text-align: center;
        margin-bottom: 30px;
        opacity: 0;
        transform: translateX(-100px);
        animation: slideInLeft 2s ease-out 2s forwards;
        position: relative;
      }

      .couple-names::before {
        content: "üíï";
        position: absolute;
        left: -50px;
        animation: heartBeat 1.5s ease-in-out infinite;
      }

      .couple-names::after {
        content: "üíï";
        position: absolute;
        right: -50px;
        animation: heartBeat 1.5s ease-in-out infinite 0.5s;
      }

      @keyframes slideInLeft {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes heartBeat {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      .message {
        font-size: 24px;
        color: #00e5ff;
        text-align: center;
        max-width: 600px;
        margin-bottom: 30px;
        opacity: 0;
        transform: translateY(50px);
        animation: fadeInUp 2s ease-out 3s forwards;
        line-height: 1.6;
        font-style: italic;
      }

      .love-quote {
        font-size: 18px;
        color: #ff6a00;
        text-align: center;
        max-width: 500px;
        margin-bottom: 40px;
        opacity: 0;
        animation: fadeInUp 2s ease-out 3.5s forwards;
        font-style: italic;
        border-left: 4px solid #ff6b9d;
        padding-left: 20px;
        position: relative;
      }

      .love-quote::before {
        content: '"';
        font-size: 60px;
        color: #ff6b9d;
        position: absolute;
        left: -10px;
        top: -20px;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
        from {
          transform: translateY(30px);
        }
      }

      .photo-gallery {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        max-width: 800px;
        margin: 40px 0;
        opacity: 0;
        animation: fadeIn 2s ease-out 4s forwards;
      }

      .photo-frame {
        position: relative;
        width: 200px;
        height: 200px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        transform: rotate(-2deg);
        transition: all 0.3s ease;
        border: 10px solid white;
      }

      .photo-frame:nth-child(2) {
        transform: rotate(2deg);
      }
      .photo-frame:nth-child(3) {
        transform: rotate(-1deg);
      }
      .photo-frame:nth-child(4) {
        transform: rotate(1deg);
      }

      .photo-frame:hover {
        transform: rotate(0deg) scale(1.1);
        z-index: 10;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
      }

      .photo-frame img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .photo-frame::after {
        content: "üì∏";
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 20px;
        opacity: 0.7;
      }

      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }

      canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0; /* Put fireworks behind main content */
      }

      .confetti-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1000;
        overflow: hidden;
      }

      .confetti-piece {
        position: absolute;
        width: 10px;
        height: 10px;
        top: -10px;
        animation: confettiFall linear forwards;
      }

      @keyframes confettiFall {
        to {
          transform: translateY(calc(100vh + 20px)) rotate(720deg);
          opacity: 0;
        }
      }

      .music-note {
        position: fixed;
        font-size: 30px;
        color: #ff6b9d;
        animation: musicFloat 4s ease-in-out infinite;
        z-index: 1100; /* Above confetti for visibility */
      }

      @keyframes musicFloat {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
          opacity: 0.7;
        }
        50% {
          transform: translateY(-30px) rotate(10deg);
          opacity: 1;
        }
      }

      .celebration-text {
        font-size: 25px;
        color: #e74c3c;
        text-align: center;
        margin-top: 30px;
        opacity: 0;
        animation: fadeInUp 2s ease-out 4.5s forwards;
        font-weight: bold;
      }

      .celebration-text::before {
        content: "üéâ ";
      }

      .celebration-text::after {
        content: " üéâ";
      }

      /* Lightbox overlay for photos */
      .lightbox-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1300; /* Above confetti (1000) and music notes (1100) */
      }
      .lightbox-overlay.open {
        display: flex;
      }
      .lightbox-content {
        position: relative;
        max-width: 90vw;
        max-height: 90vh;
      }
      .lightbox-image {
        max-width: 100%;
        max-height: 85vh;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      }
      .lightbox-camera {
        position: absolute;
        top: 12px;
        right: 12px;
        font-size: 34px;
        cursor: pointer;
        user-select: none;
        filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.5));
        transition: transform 0.15s ease;
      }
      .lightbox-camera:active {
        transform: scale(0.95);
      }
    </style>
    <style>
      @view-transition {
        navigation: auto;
      }
    </style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  </head>
  <body>
    <!-- Emoji Decorations -->
    <div class="emoji-decoration">üíñ</div>
    <div class="emoji-decoration">üíù</div>
    <div class="emoji-decoration">üåπ</div>
    <div class="emoji-decoration">üíê</div>
    <div class="emoji-decoration">‚ú®</div>
    <div class="emoji-decoration">üíç</div>
    <!-- Background Music for the experience -->
    <audio
      id="AnniversaryMusic"
      preload="auto"
      loop
      playsinline
      style="display: none"
    >
      <source
        src="https://sibgatul-hassen.github.io/wish/BackgroundMusic.m4a"
        type="audio/mp4"
      />
      <source
        src="https://sibgatul-hassen.github.io/wish/BackgroundMusic.mp3"
        type="audio/mpeg"
      />
    </audio>

    <script>
      // Scatter emoji decorations randomly across the viewport
      (function scatterEmojis() {
        try {
          const emojis = document.querySelectorAll(".emoji-decoration");
          const clamp = (min, max, v) => Math.max(min, Math.min(max, v));
          emojis.forEach((el) => {
            // Random positions with a small margin from edges
            let topP = Math.random() * 85 + 5; // 5% - 90%
            let leftP = Math.random() * 85 + 5; // 5% - 90%

            // Nudge away from the center region to reduce overlap with main content
            if (topP > 30 && topP < 70 && leftP > 25 && leftP < 75) {
              const shift =
                (Math.random() < 0.5 ? -1 : 1) * (10 + Math.random() * 15);
              if (Math.random() < 0.5) topP += shift;
              else leftP += shift;
              topP = clamp(5, 90, topP);
              leftP = clamp(5, 90, leftP);
            }

            el.style.top = topP + "%";
            el.style.left = leftP + "%";
            el.style.right = "auto";
            // Slightly desynchronize animations
            el.style.animationDelay = (Math.random() * 2).toFixed(2) + "s";
          });
        } catch (e) {
          // no-op
        }
      })();
    </script>
    <!-- Fireworks Canvas -->
    <canvas id="fireworksCanvas"></canvas
    ><!-- Confetti Container -->
    <div class="confetti-container" id="confettiContainer"></div>
    <div class="container">
      <div class="main-title" id="mainTitle">Happy Anniversary</div>
      <div class="couple-names" id="coupleNames">Sajin &amp; Habib</div>
      <div class="message" id="message">
        Celebrating 3 beautiful years together
      </div>
      <div class="love-quote" id="loveQuote">
        Love is not about how many days, months, or years you have been
        together. Love is about how much you love each other every single day.
      </div>
      <div class="photo-gallery">
        <div class="photo-frame">
          <img
            src="https://sibgatul-hassen.github.io/wish/Anniversary%20(1).jpg"
          />
        </div>
        <div class="photo-frame">
          <img
            src="https://sibgatul-hassen.github.io/wish/Anniversary%20(2).jpg"
          />
        </div>
        <div class="photo-frame">
          <img
            src="https://sibgatul-hassen.github.io/wish/Anniversary%20(3).jpg"
          />
        </div>
        <div class="photo-frame">
          <img
            src="https://sibgatul-hassen.github.io/wish/Anniversary%20(4).jpg"
          />
        </div>
      </div>
      <div class="celebration-text">
        Wishing you many more years of love and happiness!
      </div>
    </div>
    <script>
      const defaultConfig = {
        main_title: "Happy Anniversary",
        couple_names: "Sarah & Michael",
        anniversary_message: "Celebrating 5 beautiful years together",
        love_quote:
          "Love is not about how many days, months, or years you have been together. Love is about how much you love each other every single day.",
        primary_color: "#ff6b9d",
        secondary_color: "#8e44ad",
        accent_color: "#e74c3c",
        background_start: "#ffeef8",
        background_end: "#f0e6ff",
        font_family: "Playfair Display",
        font_size: 16,
      };

      async function onConfigChange(config) {
        const baseSize = config.font_size || defaultConfig.font_size;
        const customFont = config.font_family || defaultConfig.font_family;
        const titleFont = `Great Vibes, ${customFont}, cursive`;
        const nameFont = `Dancing Script, ${customFont}, cursive`;
        const bodyFont = `${customFont}, serif`;

        document.getElementById("mainTitle").textContent =
          config.main_title || defaultConfig.main_title;
        document.getElementById("mainTitle").style.fontSize = `${
          baseSize * 5
        }px`;
        document.getElementById("mainTitle").style.fontFamily = titleFont;

        document.getElementById("coupleNames").textContent =
          config.couple_names || defaultConfig.couple_names;
        document.getElementById("coupleNames").style.fontSize = `${
          baseSize * 3
        }px`;
        document.getElementById("coupleNames").style.fontFamily = nameFont;
        document.getElementById("coupleNames").style.color =
          config.secondary_color || defaultConfig.secondary_color;

        document.getElementById("message").textContent =
          config.anniversary_message || defaultConfig.anniversary_message;
        document.getElementById("message").style.fontSize = `${
          baseSize * 1.5
        }px`;
        document.getElementById("message").style.fontFamily = bodyFont;

        document.getElementById("loveQuote").textContent =
          config.love_quote || defaultConfig.love_quote;
        document.getElementById("loveQuote").style.fontSize = `${
          baseSize * 1.125
        }px`;
        document.getElementById("loveQuote").style.fontFamily = bodyFont;
        document.getElementById("loveQuote").style.borderLeftColor =
          config.primary_color || defaultConfig.primary_color;

        document.body.style.background = `linear-gradient(135deg, ${
          config.background_start || defaultConfig.background_start
        } 0%, #e8f5ff 30%, #fff4e6 70%, ${
          config.background_end || defaultConfig.background_end
        } 100%)`;
      }

      const capabilities = {
        recolorables: [
          {
            get: () =>
              window.elementSdk.config.primary_color ||
              defaultConfig.primary_color,
            set: (value) => {
              window.elementSdk.config.primary_color = value;
              window.elementSdk.setConfig({ primary_color: value });
            },
          },
          {
            get: () =>
              window.elementSdk.config.secondary_color ||
              defaultConfig.secondary_color,
            set: (value) => {
              window.elementSdk.config.secondary_color = value;
              window.elementSdk.setConfig({ secondary_color: value });
            },
          },
          {
            get: () =>
              window.elementSdk.config.accent_color ||
              defaultConfig.accent_color,
            set: (value) => {
              window.elementSdk.config.accent_color = value;
              window.elementSdk.setConfig({ accent_color: value });
            },
          },
          {
            get: () =>
              window.elementSdk.config.background_start ||
              defaultConfig.background_start,
            set: (value) => {
              window.elementSdk.config.background_start = value;
              window.elementSdk.setConfig({ background_start: value });
            },
          },
          {
            get: () =>
              window.elementSdk.config.background_end ||
              defaultConfig.background_end,
            set: (value) => {
              window.elementSdk.config.background_end = value;
              window.elementSdk.setConfig({ background_end: value });
            },
          },
        ],
        borderables: [],
        fontEditable: {
          get: () =>
            window.elementSdk.config.font_family || defaultConfig.font_family,
          set: (value) => {
            window.elementSdk.config.font_family = value;
            window.elementSdk.setConfig({ font_family: value });
          },
        },
        fontSizeable: {
          get: () =>
            window.elementSdk.config.font_size || defaultConfig.font_size,
          set: (value) => {
            window.elementSdk.config.font_size = value;
            window.elementSdk.setConfig({ font_size: value });
          },
        },
      };

      function mapToEditPanelValues(config) {
        return new Map([
          ["main_title", config.main_title || defaultConfig.main_title],
          ["couple_names", config.couple_names || defaultConfig.couple_names],
          [
            "anniversary_message",
            config.anniversary_message || defaultConfig.anniversary_message,
          ],
          ["love_quote", config.love_quote || defaultConfig.love_quote],
        ]);
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: () => capabilities,
          mapToEditPanelValues,
        });
      }

      // Fireworks Animation
      const canvas = document.getElementById("fireworksCanvas");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const particles = [];

      function createFirework(x, y) {
        const colors = [
          "#ff6b9d",
          "#ffd93d",
          "#6bcf7f",
          "#4d9de0",
          "#e15554",
          "#c44569",
          "#f368e0",
        ];
        const particleCount = 60;

        for (let i = 0; i < particleCount; i++) {
          particles.push({
            x: x,
            y: y,
            vx: (Math.random() - 0.5) * 10,
            vy: (Math.random() - 0.5) * 10,
            life: 120,
            color: colors[Math.floor(Math.random() * colors.length)],
            size: Math.random() * 4 + 2,
          });
        }
      }

      function animateFireworks() {
        ctx.fillStyle = "rgba(255, 255, 255, 0.05)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.15;
          p.life -= 1;

          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fillStyle = p.color;
          ctx.globalAlpha = p.life / 120;
          ctx.fill();

          if (p.life <= 0) {
            particles.splice(i, 1);
          }
        }

        ctx.globalAlpha = 1;
        requestAnimationFrame(animateFireworks);
      }

      animateFireworks();

      // Launch fireworks periodically
      setInterval(() => {
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height * 0.6;
        createFirework(x, y);
      }, 1200);

      // Confetti Animation
      function createConfetti() {
        const confettiContainer = document.getElementById("confettiContainer");
        const colors = [
          "#ff6b9d",
          "#ffd93d",
          "#6bcf7f",
          "#4d9de0",
          "#e15554",
          "#c44569",
          "#f368e0",
        ];

        for (let i = 0; i < 3; i++) {
          const confetti = document.createElement("div");
          confetti.className = "confetti-piece";
          confetti.style.left = Math.random() * 100 + "%";
          confetti.style.backgroundColor =
            colors[Math.floor(Math.random() * colors.length)];
          confetti.style.animationDuration = Math.random() * 3 + 2 + "s";
          confetti.style.animationDelay = Math.random() * 2 + "s";
          confetti.style.borderRadius = Math.random() > 0.5 ? "50%" : "0";
          confetti.style.width = Math.random() * 8 + 6 + "px";
          confetti.style.height = Math.random() * 8 + 6 + "px";

          confettiContainer.appendChild(confetti);

          setTimeout(() => {
            if (confetti.parentNode) {
              confetti.remove();
            }
          }, 5000);
        }
      }

      // Create confetti continuously
      setInterval(createConfetti, 200);

      // Music Notes Animation
      function createMusicNote() {
        const notes = ["üéµ", "üé∂", "üéº"];
        const note = document.createElement("div");
        note.className = "music-note";
        note.textContent = notes[Math.floor(Math.random() * notes.length)];
        note.style.left = Math.random() * 90 + "%";
        note.style.top = Math.random() * 80 + "%";
        note.style.animationDelay = Math.random() * 2 + "s";
        document.body.appendChild(note);

        setTimeout(() => note.remove(), 4000);
      }

      // Create music notes periodically
      setInterval(createMusicNote, 2000);

      // Resize handler
      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });

      // Initial burst of confetti and fireworks
      setTimeout(() => {
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            createFirework(
              Math.random() * canvas.width,
              Math.random() * canvas.height * 0.5
            );
          }, i * 200);
        }
      }, 1000);
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'998169c2b55d7871',t:'MTc2MjA2MzI0My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
    <script>
      // Minimal music bootstrap: start on message or first user gesture, then notify parent
      (function setupMusic() {
        const audio = document.getElementById("AnniversaryMusic");
        if (!audio) return;

        function playMusic() {
          try {
            const p = audio.play();
            if (p && typeof p.then === "function") {
              p.then(() => {
                try {
                  window.parent &&
                    window.parent.postMessage("AUDIO_STARTED", "*");
                } catch (e) {}
              }).catch(() => {});
            }
          } catch (e) {}
        }

        // Start when the launcher asks
        window.addEventListener("message", (event) => {
          const data = event && event.data;
          if (data === "START_AUDIO" || (data && data.type === "START_AUDIO")) {
            playMusic();
          }
        });

        // Also start on first user gesture inside the experience (fallback)
        const once = () => {
          playMusic();
          document.removeEventListener("click", once);
          document.removeEventListener("touchend", once);
          document.removeEventListener("keydown", keyOnce);
        };
        const keyOnce = (e) => {
          if (
            e.key === "Enter" ||
            e.key === " " ||
            e.key === "Spacebar" ||
            e.key === "f" ||
            e.key === "F"
          )
            once();
        };
        document.addEventListener("click", once, { once: true, passive: true });
        document.addEventListener("touchend", once, {
          once: true,
          passive: true,
        });
        document.addEventListener("keydown", keyOnce, { passive: true });

        // If it starts playing for any reason, notify parent
        audio.addEventListener(
          "playing",
          () => {
            try {
              window.parent && window.parent.postMessage("AUDIO_STARTED", "*");
            } catch (e) {}
          },
          { once: true }
        );
      })();
    </script>
    <script>
      // Fullscreen integration without altering existing functionality
      (function setupFullscreen() {
        function enterFullscreenAndStart() {
          const el = document.documentElement;
          const req =
            el.requestFullscreen ||
            el.webkitRequestFullscreen ||
            el.msRequestFullscreen;
          if (req) {
            try {
              const p = req.call(el);
              // Some browsers return a promise
              if (p && typeof p.catch === "function") p.catch(() => {});
            } catch (e) {
              // ignore
            }
          }
        }

        // Expose globally so you can call it manually if needed
        window.enterFullscreenAndStart = enterFullscreenAndStart;

        // Helper to check current fullscreen state
        function isFullscreenActive() {
          return (
            document.fullscreenElement ||
            document.webkitFullscreenElement ||
            document.msFullscreenElement
          );
        }

        // Try to enter fullscreen automatically at start (may be blocked by browser policy)
        let autoTried = false;
        function tryAutoFullscreen() {
          if (autoTried || isFullscreenActive()) return;
          autoTried = true;
          enterFullscreenAndStart();
        }

        // Attempt ASAP on DOM ready / load / when tab becomes visible
        if (
          document.readyState === "complete" ||
          document.readyState === "interactive"
        ) {
          setTimeout(tryAutoFullscreen, 0);
        } else {
          document.addEventListener("DOMContentLoaded", tryAutoFullscreen, {
            once: true,
          });
        }
        window.addEventListener(
          "load",
          () => setTimeout(tryAutoFullscreen, 0),
          { once: true }
        );
        document.addEventListener("visibilitychange", () => {
          if (
            document.visibilityState === "visible" &&
            !autoTried &&
            !isFullscreenActive()
          ) {
            tryAutoFullscreen();
          }
        });

        // Trigger on first user interaction (required by browsers)
        function requestOnce() {
          enterFullscreenAndStart();
          document.removeEventListener("click", requestOnce);
          document.removeEventListener("touchend", requestOnce);
          document.removeEventListener("keydown", keyHandler);
        }

        function keyHandler(e) {
          if (e.key === "Enter" || e.key === "f" || e.key === "F") {
            requestOnce();
          }
        }

        const isFs =
          document.fullscreenElement ||
          document.webkitFullscreenElement ||
          document.msFullscreenElement;
        if (!isFs) {
          document.addEventListener("click", requestOnce, {
            once: true,
            passive: true,
          });
          document.addEventListener("touchend", requestOnce, {
            once: true,
            passive: true,
          });
          document.addEventListener("keydown", keyHandler, { passive: true });
        }
      })();
    </script>
    <!-- Lightbox overlay (photos) -->
    <div id="lightboxOverlay" class="lightbox-overlay" aria-hidden="true">
      <div
        class="lightbox-content"
        role="dialog"
        aria-modal="true"
        aria-label="Photo viewer"
      >
        <img id="lightboxImage" class="lightbox-image" alt="Photo preview" />
        <div id="lightboxCamera" class="lightbox-camera" title="Close">üì∏</div>
      </div>
    </div>

    <script>
      (function () {
        const overlay = document.getElementById("lightboxOverlay");
        const imageEl = document.getElementById("lightboxImage");
        const cameraBtn = document.getElementById("lightboxCamera");
        if (!overlay || !imageEl || !cameraBtn) return;

        const openOverlay = (src, alt) => {
          imageEl.src = src;
          imageEl.alt = alt || "Photo";
          overlay.classList.add("open");
          document.body.style.overflow = "hidden";
        };
        const closeOverlay = () => {
          overlay.classList.remove("open");
          document.body.style.overflow = "";
          imageEl.src = "";
        };

        cameraBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          closeOverlay();
        });
        overlay.addEventListener("click", (e) => {
          if (e.target === overlay) closeOverlay();
        });
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && overlay.classList.contains("open"))
            closeOverlay();
        });

        const imgs = document.querySelectorAll(".photo-gallery img");
        imgs.forEach((img) => {
          img.style.cursor = "zoom-in";
          img.addEventListener("click", () => openOverlay(img.src, img.alt));
        });
      })();
    </script>
  </body>
</html>
